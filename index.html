<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Mini Minecraft 3D – Créatif</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;background:#1b1b1b;color:white;font-family:Arial;text-align:center}
canvas{background:#87ceeb;display:block;margin:10px auto;border:2px solid white}
#ui{display:flex;justify-content:center;gap:10px;flex-wrap:wrap}
.block{width:30px;height:30px;border:2px solid white;cursor:pointer}
.selected{outline:3px solid yellow}
</style>
</head>
<body>
<h2>Mini Minecraft 3D (Créatif)</h2>
<p>ZQSD / WASD = bouger | Espace = sauter | Clic = placer</p>

<div id="ui">
  <div class="block selected" data-color="#4CAF50" style="background:#4CAF50"></div>
  <div class="block" data-color="#795548" style="background:#795548"></div>
  <div class="block" data-color="#9E9E9E" style="background:#9E9E9E"></div>
</div>

<canvas id="game" width="900" height="500"></canvas>

<script>
const canvas=document.getElementById('game');
const ctx=canvas.getContext('2d');

const TILE=32;
const MAP=20;

let currentColor='#4CAF50';
document.querySelectorAll('.block').forEach(b=>{
  b.onclick=()=>{
    document.querySelectorAll('.block').forEach(x=>x.classList.remove('selected'));
    b.classList.add('selected');
    currentColor=b.dataset.color;
  }
});

// Monde 3D simple (x,y,z)
let world=[];
for(let x=0;x<MAP;x++){
  world[x]=[];
  for(let y=0;y<MAP;y++){
    world[x][y]=[];
  }
}

// Joueur
const player={x:10,y:10,z:1,vz:0};
const gravity=0.08;

const keys={};
document.addEventListener('keydown',e=>keys[e.key.toLowerCase()]=true);
document.addEventListener('keyup',e=>keys[e.key.toLowerCase()]=false);

canvas.addEventListener('click',()=>{
  const bx=Math.floor(player.x);
  const by=Math.floor(player.y);
  const bz=Math.floor(player.z);
  world[bx][by][bz]=currentColor;
});

function update(){
  let speed=0.08;
  if(keys['w']||keys['z']) player.y-=speed;
  if(keys['s']) player.y+=speed;
  if(keys['a']||keys['q']) player.x-=speed;
  if(keys['d']) player.x+=speed;

  // gravité
  player.vz-=gravity;
  player.z+=player.vz;

  // collision sol
  const bx=Math.floor(player.x);
  const by=Math.floor(player.y);
  const below=Math.floor(player.z-0.1);
  if(below>=0 && world[bx]?.[by]?.[below]){
    player.z=below+1;
    player.vz=0;
  }

  if(player.z<1){player.z=1;player.vz=0;}

  if(keys[' ']){
    if(player.vz===0) player.vz=0.6;
  }
}

function iso(x,y,z){
  return{
    x:(x-y)*TILE+canvas.width/2,
    y:(x+y)*TILE/2 - z*TILE + 150
  }
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // blocs
  for(let z=0;z<6;z++){
    for(let x=0;x<MAP;x++){
      for(let y=0;y<MAP;y++){
        if(world[x][y][z]){
          const p=iso(x,y,z);
          ctx.fillStyle=world[x][y][z];
          ctx.fillRect(p.x,p.y,TILE,TILE);
        }
      }
    }
  }

  // joueur
  const p=iso(player.x,player.y,player.z);
  ctx.fillStyle='red';
  ctx.fillRect(p.x,p.y,16,24);
}

function loop(){update();draw();requestAnimationFrame(loop)}
loop();
</script>
</body>
</html>

